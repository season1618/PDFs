\section{微分}

\subsection{一変数関数の微分}
	\begin{dfn}[常微分]
		実数値関数$f : (a, b) \to \R$と$x_0 \in (a, b)$に対し、
			\[\lim_{h \to 0} \frac{f(x_0 + h) - f(x_0)}{h}\]
		が存在するとき、$f$は$x_0$で微分可能であると言い、$f'(x_0)$と書く。
	\end{dfn}
	\begin{prop}
		関数$f$が$x = c$で微分可能なら$x = c$で連続。
	\end{prop}
	
	\begin{thm}[ロルの定理]
		関数$f$が閉区間$[a, b]$で連続かつ開区間$(a, b)$で微分可能とする。$f'(a) = f'(b) = 0$ならば$f'(c) = 0$となる$a < c < b$が存在する。
	\end{thm}
	\begin{thm}[平均値の定理]
		関数$f$が閉区間$[a, b]$で連続かつ開区間$(a, b)$で微分可能とする。このとき$f'(c) = \frac{f(b) - f(a)}{b - a}$となる$a < c < b$が存在する。
	\end{thm}
	\begin{thm}[コーシーの平均値の定理]
		関数$f,g$が閉区間$[a, b]$で連続かつ開区間$(a, b)$で微分可能とする。$g'(x) \neq 0$なら$g(a) \neq g(b)$で
			\[\frac{f(b) - f(a)}{g(b) - g(a)} = \frac{f'(c)}{g'(c)}\]
		となる$a < c < b$が存在。
	\end{thm}
	\begin{prop}[合成関数の微分]
		$f$が$x_0$で微分可能かつ$g$が$f(x_0)$で微分可能なら$g\circ f$も$x_0$で微分可能で
			\[(g\circ f)'(x_0) = g'(f(x_0))f'(x_0)\]
		が成り立つ。
	\end{prop}
	\begin{prop}[逆関数の微分]
	\end{prop}
	\begin{thm}[ロピタルの定理]
		関数$f,g$が開区間$(a, b)$で微分可能で、以下のいずれかを満たすとき
		\begin{enumerate}
			\item $\lim_{x \to a+0} f(x) = \lim_{x \to a+0} g(x) = 0$
			\item $\lim_{x \to a+0} f(x) = \lim_{x \to a+0} g(x) = \infty$
		\end{enumerate}
		$g'(x) \neq 0(a < x < b)$かつ$\lim_{x \to a+0} f'(x)/g'(x)$が存在すれば
			\[\lim_{x \to a+0} \frac{f(x)}{g(x)} = \lim_{x \to a+0} \frac{f'(x)}{g'(x)}\]
		左極限についても同様。
	\end{thm}
	\begin{proof}
			\[\lim_{x \to a+0} f(x) = \lim_{x \to a+0} g(x) = 0\]
		のとき$f(a) = g(a) = 0$とすると関数$f,g$は$[a, b)$で連続となる。$a < t < b$としたときコーシーの平均値の定理より
			\[\frac{f(t)}{g(t)} = \frac{f(t) - f(a)}{g(t) - g(a)} = \frac{f'(c)}{g'(c)}\]
		となる$c$が存在する。$t \to a+0$のとき$c \to a+0$なので
			\[\lim_{x \to a+0} \frac{f(x)}{g(x)} = \lim_{x \to a+0} \frac{f'(x)}{g'(x)}\]
	\end{proof}
	\begin{cor}
		関数$f,g$が一点$c$を除く開区間$(a, b)$で微分可能で、以下のいずれかを満たすとき
		\begin{enumerate}
			\item $\lim_{x \to c} f(x) = \lim_{x \to c} g(x) = 0$
			\item $\lim_{x \to c} f(x) = \lim_{x \to c} g(x) = \infty$
		\end{enumerate}
		$g'(x) \neq 0(a < x < b)$かつ$\lim_{x \to c} f'(x)/g'(x)$が存在すれば
			\[\lim_{x \to c} \frac{f(x)}{g(x)} = \lim_{x \to c} \frac{f'(x)}{g'(x)}\]
	\end{cor}

	\begin{thm}[テイラーの定理]
		関数$f$が閉区間$[a, b]$で連続かつ開区間$(a, b)$で$n+1$階微分可能であるとき
		\begin{gather*}
			f(b) = f(a) + \frac{f'(a)}{1!}(b - a) + \frac{f''(a)}{2!}(b - a)^2 + \dots + \frac{f^{(n)}(a)}{n!}(b - a)^n + R_{n+1}\\
			R_{n+1} = \frac{f^{(n+1)}(c)}{(n+1)!}(b - a)^{n+1} = \frac{f^{(n+1)}(d)}{n!}(d - a)^n(b - a)\\
		\end{gather*}
		となる$a < c,d < b$が存在する。$R_{n+1}$を剰余項と呼ぶ。
	\end{thm}
	\begin{proof}
		$f, f', \dots, f^{(n)}$は閉区間$[a, b]$で連続かつ開区間$(a, b)$で微分可能。平均値の定理より
	\end{proof}

	\begin{cor}
		関数$f$が開区間$(a, b)$で$n+1$階微分可能とすると$c, x \in (a, b)$について
			\[f(x) = f(c) + \frac{f'(c)}{1!}(x - c) + \frac{f''(c)}{2!}(x - c)^2 + \dots + \frac{f^{(n)}(c)}{n!}(x - c)^n + R_{n+1}(x)\]
		ただし
		\begin{align*}
			R_{n+1}(x) &= \frac{f^{(n+1)}(d_1)}{(n+1)!}(x - c)^{n+1} & (ラグランジュの剰余項表示)\\
			R_{n+1}(x) &= \frac{f^{(n+1)}(d_2)}{n!}(d_2 - c)^n(x - c) & (コーシーの剰余項表示)\\
		\end{align*}
	\end{cor}

	ある$r > 0$が存在して$|x - c| < r$に対して$\lim_{n \to \infty} R_{n+1}(x) = 0$となるなら
		\[f(x) = \sum_{n = 0}^\infty \frac{f^{(n)}(a)}{n!}(x - c)^n (|x - c| < r)\]
	となる。これを関数$f(x)$の$x = c$におけるテイラー展開という。特に原点$x = 0$におけるテイラー展開をマクローリン展開という。

\subsection{多変数関数の微分}
	\begin{dfn}[全微分]
			\[\lim_{x \to c} \frac{f(x) - f(c) - v(c) \cdot (x - c)}{|x - c|} = 0\]
		であるとき$f(x)$は$c$で全微分可能であるという。このとき$df = v(c) \cdot dx$を$c$における全微分という。
	\end{dfn}
	\begin{dfn}[偏微分]
		任意の$1 \leq i \leq n$に対して
			\[\pd[f]{x_i}(c) \coloneqq \lim_{h \to 0} \frac{f(c + he_i) - f(c)}{h}\]
		が存在するとき$f(x)$は$c$において$x_i$に関して偏微分可能であるという。一変数関数の場合、偏微分は常微分に一致する。
	\end{dfn}
	\begin{dfn}
		関数$f$が$C^r$級であるとは、任意の組合せにおいて$f$が$r$階偏微分可能でかつ連続であること。
	\end{dfn}
	\begin{prop}
		$f$が$c$において全微分可能なら、$f$は$c$において連続かつ任意の$x_i$に関して偏微分可能であり、
			\[\pd[f]{x_i} = v_i\]
	\end{prop}
	\begin{proof}
		\begin{align*}
			\lim_{x \to x_0} f(x) - f(x_0) 
			&= \lim_{x \to x_0} f(x) - f(x_0) - v \cdot (x - x_0)\\
			&= \lim_{x \to x_0} \frac{f(x) - f(x_0) - v \cdot (x - x_0)}{|x - x_0|} \cdot \lim_{x \to x_0} {|x - x_0|} = 0\\
		\end{align*}
		より連続。
			\[\lim_{x \to x_0} \frac{f(x) - f(x_0) - v \cdot (x - x_0)}{|x - x_0|} = 0\]
		で$x - x_0 = he_i$とすると
		\begin{align*}
			\lim_{h \to 0} \frac{f(x_0 + he_i) - f(x_0) - v \cdot he_i}{h} = 0\\
			\lim_{h \to 0} \frac{f(x_0 + he_i) - f(x_0)}{h} = v \cdot e_i\\
		\end{align*}
	\end{proof}

	\begin{prop}
		$f$が$C^1$級なら全微分可能。
	\end{prop}
	\begin{proof}
		2変数の場合に証明する。

		平均値の定理より
		\begin{align*}
			\frac{f(a + h, b + k) - f(a, b + k)}{h} &= f_x(a + t_1, b + k)\\
			\frac{f(a, b + k) - f(a, b)}{k} &= f_y(a, b + t_2)\\
		\end{align*}
		となる$0 < t_1 < h, 0 < t_2 < k$が存在する。
		\begin{align*}
			f(a + h, b + k) - f(a, b)
			&= f(a + h, b + k) - f(a, b + k) + f(a, b + k) - f(a, b)\\
			&= \frac{f(a + h, b + k) - f(a, b + k)}{h}h + \frac{f(a, b + k) - f(a, b)}{k}k\\
			&= f_x(a + t_1, b + k)h + f_y(a, b + t_2)k\\
		\end{align*}
		\begin{align*}
			& f(a + h, b + k) - f(a, b) - f_x(a, b)h - f_y(a, b)k\\
			&= (f_x(a + t_1, b + k) - f_x(a, b))h + (f_y(a, b + t_2) - f_y(a, b))k\\
			& \lim_{(h, k) \to (0, 0)}\frac{f(a + h, b + k) - f(a, b) - f_x(a, b)h - f_y(a, b)k}{\sqrt(h^2 + k^2)}\\
			&= \lim_{(h, k) \to (0, 0)}(f_x(a + t_1, b + k) - f_x(a, b))\frac{h}{\sqrt{h^2 + k^2}}\\
			&+ \lim_{(h, k) \to (0, 0)}(f_y(a, b + t_2) - f_y(a, b))\frac{k}{\sqrt{h^2 + k^2}}\\
			&= 0
		\end{align*}
	\end{proof}

	\begin{prop}
		$f$が$C^2$級なら$f_{xy} = f_{yx}$
	\end{prop}
	\begin{proof}
		\begin{align*}
			g(x) &= \frac{f(x, b + k) - f(x, b)}{k}\\
			d_{(a, b)}(h, k)
			&= \frac{f(a + h, b + k) - f(a + h, b) - f(a, b + k) + f(a, b)}{hk}\\
			&= \frac{g(a + h) - g(a)}{h}\\
		\end{align*}
		とおく。平均値の定理より
		\begin{align*}
			d_{(a, b)}(h, k)
			&= \frac{g(a + h) - g(a)}{h} = g'(a + t_1)\\
			&= \frac{f_x(a + t_1, b + k) - f_x(a + t_1, b)}{k}\\
			&= f_{xy}(a + t_1, b + t_2)\\
		\end{align*}
		となる$0 < t_1 < h, 0 < t_2 < k$が存在する。よって
			\[\lim_{(h, k) \to (0, 0)}d_{(a, b)}(h, k) = \lim_{(h, k) \to (0, 0)}f_{xy}(a + t_1, b + t_2) = f_{xy}(a, b)\]
		同様に
			\[\lim_{(h, k) \to (0, 0)}d_{(a, b)}(h, k) = f_{yx}(a, b)\]
		なので$f_{xy} = f_{yx}$。
	\end{proof}
	\begin{cor}
		$f$が$C^r$級なら$r$階までの偏微分は微分の順番に依らない。
	\end{cor}

	\begin{prop}[合成関数の微分]
		$f$が$x(t)$で全微分可能で、$x(t)$が$t_0$で微分可能であるとき、合成関数$f(x(t))$は$t_0$で微分可能であり、
			\[\de[f]{t} = \sum_i \pd[f]{x_i}\de[x_i]{t}\]
		となる。
	\end{prop}
	\begin{proof}
		\begin{gather*}
			\lim_{h \to 0} \frac{f(x(t_0 + h)) - f(x(t_0)) - \pd[f]{x}(x(t_0)) \cdot (x(t_0 + h) - x(t_0))}{|x(t_0 + h) - x(t_0)|} = 0\\
	        \lim_{h \to 0} \frac{f(x(t_0 + h)) - f(x(t_0))}{|x(t_0 + h) - x(t_0)|} = \lim_{h \to 0} \pd[f]{x}(x(t_0)) \cdot \frac{(x(t_0 + h) - x(t_0))}{|x(t_0 + h) - x(t_0)|}
	    \end{gather*}
	    \begin{align*}
	        \lim_{h \to 0} \frac{f(x(t_0 + h)) - f(x(t_0))}{h}
	        &= \lim_{h \to 0} \frac{f(x(t_0 + h)) - f(x(t_0))}{|x(t_0 + h) - x(t_0)|}\frac{|x(t_0 + h) - x(t_0)|}{h}\\
			&= \lim_{h \to 0} \pd[f]{x}(x(t_0)) \cdot \frac{(x(t_0 + h) - x(t_0))}{|x(t_0 + h) - x(t_0)|}\frac{|x(t_0 + h) - x(t_0)|}{h}\\
			&= \lim_{h \to 0} \pd[f]{x}(x(t_0)) \cdot \frac{(x(t_0 + h) - x(t_0))}{h}\\
			&= \pd[f]{x}(x(t_0)) \cdot \de[x]{t}
		\end{align*}
	\end{proof}

	\begin{cor}
		$f$が$(x, y) = (a, b)$で全微分可能で、$x = x(u, v), y = y(u, v)$が$(u, v) = (c, d)$で偏微分可能であるとき、
		\begin{align*}
			\pd[f]{u} &= \pd[f]{x}\pd[x]{u} + \pd[f]{y}\pd[y]{u}\\
			\pd[f]{v} &= \pd[f]{x}\pd[x]{v} + \pd[f]{y}\pd[y]{v}\\
		\end{align*}
		が成り立つ。
			\[(f_x, f_y) = (f_u, f_v) \cdot \begin{pmatrix} x_u & x_v \\ y_u & y_v \\\end{pmatrix}\]
		を
			\[\pd[f]{(x, y)} = \pd[f]{(u, v)} \cdot \pd[(x, y)]{(u, v)}\]
		と表す。$\pd[(x, y)]{(u, v)}$をヤコビ行列(ヤコビアン)という。
	\end{cor}

	\begin{thm}[テイラーの定理]
	\end{thm}

\begin{dfn}[極値]
	ある$r > 0$が存在して$0 < |x - c| < r$ならば$f(x) < f(c)$が成り立つとき$f$は$c$において極大値$f(c)$を取ると言い、$f(x) > f(c)$ならば$f$は$c$において極小値$f(c)$を取るという。極大値と極小値を極値という。等号を含める場合広義の極値という。
\end{dfn}
任意の偏微分が0である点を臨界点(停留点)と呼ぶ。
\begin{prop}
	$C^1$級関数$f$が$c$で極値を取るなら$c$は臨界点である。
\end{prop}
\begin{thm}
	$C^2$級関数$f$について、ヘッセ行列$(f_{x_ix_j})$の固有値が全て正のとき、$f$はその点において極小値を取り、全て負のとき、極大値を取る。
\end{thm}